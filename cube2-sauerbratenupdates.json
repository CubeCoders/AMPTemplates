[
    {
        "UpdateStageName": "Server-init.cfg Backup",
        "UpdateSourcePlatform": "All",
        "UpdateSource": "CopyFilePath",
        "UpdateSourceData": "{{$FullBaseDir}}server-init.cfg.bak",
        "UpdateSourceArgs": "{{$FullBaseDir}}server-init.cfg",
        "OverwriteExistingFiles": true,
        "SkipOnFailure": true
    },
    {
        "UpdateStageName": "Server Installation",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "Executable",
        "UpdateSourceData": "powershell.exe",
        "UpdateSourceArgs": "-NoProfile -Command \"$ProgressPreference='SilentlyContinue'; Set-Location -Path 'cube2-sauerbraten'; $downloadUrl = (Invoke-WebRequest -UseBasicParsing -Uri 'https://sourceforge.net/projects/sauerbraten/files/sauerbraten/2020_11_29/sauerbraten_2020_12_21_windows.exe/download' -Headers @{\\\"User-Agent\\\"=\\\"Mozilla/5.0\\\"} -MaximumRedirection 10).Headers.Location; Invoke-WebRequest -UseBasicParsing -Uri $downloadUrl -OutFile 'sauerbraten.exe'; Start-Process -FilePath 'sauerbraten.exe' -ArgumentList \\\"/S /D=.\\\\\\\" -Wait -NoNewWindow; if ($?) { Write-Output \\\"Server installed\\\"; Remove-Item -Path 'sauerbraten.exe' -Force -ErrorAction SilentlyContinue | Out-Null }\"",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Installation",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "Executable",
        "UpdateSourceData": "/bin/bash",
        "UpdateSourceArgs": "-c \"cd cube2-sauerbraten && wget -qO sauerbraten.tar.bz2 https://sourceforge.net/projects/sauerbraten/files/sauerbraten/2020_11_29/sauerbraten_2020_12_29_linux.tar.bz2/download && tar -xjf sauerbraten.tar.bz2 --strip-components=1 && echo \\\"Server installed\\\" && rm -f sauerbraten.tar.bz2\"",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server-init.cfg Restore",
        "UpdateSourcePlatform": "All",
        "UpdateSource": "CopyFilePath",
        "UpdateSourceData": "{{$FullBaseDir}}server-init.cfg",
        "UpdateSourceArgs": "{{$FullBaseDir}}server-init.cfg.bak",
        "OverwriteExistingFiles": true,
        "SkipOnFailure": true
    }
]