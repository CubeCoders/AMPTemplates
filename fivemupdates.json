[
    {
        "UpdateStageName": "Create Server Directory",
        "UpdateSourcePlatform": "All",
        "UpdateSource": "CreateDirectory",
        "UpdateSourceArgs": "{{$FullBaseDir}}server",
        "OverwriteExistingFiles": false,
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Create Data Directory",
        "UpdateSourcePlatform": "All",
        "UpdateSource": "CreateDirectory",
        "UpdateSourceArgs": "{{$FullBaseDir}}server-data",
        "OverwriteExistingFiles": false,
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Delete Binary Directory Contents",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "Executable",
        "UpdateSourceData": "/bin/bash",
        "UpdateSourceArgs": "-c \"rm -rf \\\"{{$FullBaseDir}}server/alpine/\\\"* >/dev/null 2>&1\"",
        "SkipOnFailure": true
    },
    {
        "UpdateStageName": "Delete Binary Directory Contents",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "Executable",
        "UpdateSourceData": "cmd.exe",
        "UpdateSourceArgs": "/C del /Q /F \"{{$FullBaseDir}}server\\alpine\\\"* > NUL 2>&1",
        "SkipOnFailure": true
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/win32/server",
        "UpdateSourceArgs": "$.recommended_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": true,
        "OverwriteExistingFiles": true,
        "DeleteAfterExtract": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "recommended_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/linux/server",
        "UpdateSourceArgs": "$.recommended_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": false,
        "OverwriteExistingFiles": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "recommended_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/win32/server",
        "UpdateSourceArgs": "$.optional_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": true,
        "OverwriteExistingFiles": true,
        "DeleteAfterExtract": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "optional_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/linux/server",
        "UpdateSourceArgs": "$.optional_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": false,
        "OverwriteExistingFiles": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "optional_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/win32/server",
        "UpdateSourceArgs": "$.latest_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": true,
        "OverwriteExistingFiles": true,
        "DeleteAfterExtract": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "latest_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/linux/server",
        "UpdateSourceArgs": "$.latest_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": false,
        "OverwriteExistingFiles": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "latest_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/win32/server",
        "UpdateSourceArgs": "$.critical_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": true,
        "OverwriteExistingFiles": true,
        "DeleteAfterExtract": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "critical_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "FetchURLFromJQ",
        "UpdateSourceData": "https://changelogs-live.fivem.net/api/changelog/versions/linux/server",
        "UpdateSourceArgs": "$.critical_download",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": false,
        "OverwriteExistingFiles": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "critical_download",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "FetchURL",
        "UpdateSourceData": "{{SpecificBuildVersionURL}}",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": true,
        "OverwriteExistingFiles": true,
        "DeleteAfterExtract": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "SpecificVersion",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Download",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "FetchURL",
        "UpdateSourceData": "{{SpecificBuildVersionURL}}",
        "UpdateSourceTarget": "{{$FullBaseDir}}server",
        "UnzipUpdateSource": false,
        "OverwriteExistingFiles": true,
        "UpdateSourceConditionSetting": "ServerBuild",
        "UpdateSourceConditionValue": "SpecificVersion",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Server Extract",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "Executable",
        "UpdateSourceData": "/bin/bash",
        "UpdateSourceArgs": "-c \"cd ./fivem/server && tar -xf fx.tar.xz >/dev/null && rm -f fx.tar.xz\"",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "Clone Resources Repo",
        "UpdateSourcePlatform": "All",
        "UpdateSource": "GitRepo",
        "UpdateSourceData": "{{ResourceRepo}}",
        "UpdateSourceTarget": "{{$FullBaseDir}}server-data"
    },
    {
        "UpdateStageName": "Server.cfg Template Download",
        "UpdateSourcePlatform": "All",
        "UpdateSource": "FetchURL",
        "UpdateSourceData": "https://raw.githubusercontent.com/CubeCoders/AMPTemplates/main/fivemserver.cfg",
        "UpdateSourceArgs": "AMP_server.cfg",
        "UpdateSourceTarget": "{{$FullInstanceDir}}",
        "OverwriteExistingFiles": true,
        "SkipOnFailure": false
    }
]