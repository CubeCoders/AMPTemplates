[
    {
        "UpdateStageName": "BDSX Shell Preparation",
        "UpdateSourcePlatform": "Windows",
        "UpdateSource": "Executable",
        "UpdateSourceData": "cmd.exe",
        "UpdateSourceArgs": "/C cd bdsx/server && set PATH={{$FullRootDir}}node;%PATH% && :loop & npm run -s shellprepare & set exitcode=%errorlevel% & if %exitcode% equ 2 (rd /S /Q node_modules & npm install --unsafe-perm & goto loop) elif %exitcode% neq 1 (exit /b 1) else (exit /b 0)",
        "SkipOnFailure": false
    },
    {
        "UpdateStageName": "BDSX Shell Preparation",
        "UpdateSourcePlatform": "Linux",
        "UpdateSource": "Executable",
        "UpdateSourceData": "/bin/bash",
        "UpdateSourceArgs": "-c \"cd bdsx/server && export PATH={{$FullRootDir}}/node/bin:$PATH && while :; do npm run -s shellprepare; exitcode=$?; if [ $exitcode -eq 2 ]; then rm -rf ./node_modules; npm install --unsafe-perm; continue; elif [ $exitcode -ne 1 ]; then exit 1; else exit 0; fi; done\"",
        "SkipOnFailure": false
    }
]
